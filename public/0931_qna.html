<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>온통대전 문의 · Q&A</title>
  <style>
    :root{
      --brand:#FF8215;
      --bg:#f7f8fc;
      --surface:#ffffff;
      --ink:#1f2430;
      --muted:#6b7280;
      --line:#e5e7eb;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:"Pretendard","Noto Sans KR",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:var(--bg);
      color:var(--ink);
      display:flex;
      flex-direction:column;
      min-height:100vh;
    }
    header{
      background:linear-gradient(135deg, rgba(255,130,21,0.92), rgba(255,195,125,0.9));
      padding:56px 20px 72px;
      text-align:center;
      color:#fff;
    }
    header h1{ margin:0; font-size:34px; }
    header p{ margin:16px auto 0; max-width:560px; line-height:1.7; font-size:16px; }

    main{ flex:1; margin-top:-48px; padding:0 20px 80px; }
    .container{ max-width:980px; margin:0 auto; display:grid; gap:32px; }

    .board{
      background:var(--surface);
      border-radius:24px;
      padding:32px;
      box-shadow:0 16px 40px rgba(31,36,48,.1);
      border:1px solid rgba(255,130,21,.1);
      display:grid;
      gap:20px;
    }
    .board h2{ margin:0; font-size:24px; display:flex; align-items:center; gap:12px; }
    .board h2 span{ display:inline-flex; align-items:center; justify-content:center; width:40px; height:40px; border-radius:12px; background:rgba(255,130,21,.18); color:var(--brand); font-weight:700; }
    .board p{ margin:0; color:var(--muted); }

    .post-list{ list-style:none; margin:0; padding:0; border-top:1px solid var(--line); }
    .post-item{ border-bottom:1px solid var(--line); padding:16px 0; display:grid; gap:6px; cursor:pointer; transition:background .2s ease; }
    .post-item:hover{ background:rgba(255,130,21,.05); }
    .post-meta{ display:flex; gap:12px; color:var(--muted); font-size:13px; }
    .post-title{ font-size:16px; font-weight:600; display:flex; align-items:center; gap:8px; }
    .post-content{ display:none; padding:12px 14px; background:rgba(255,130,21,.05); border-radius:12px; line-height:1.6; white-space:pre-line; }
    .post-item.open .post-content{ display:block; }
    .lock{ color:#ef4444; font-size:18px; }

    form{ display:grid; gap:16px; }
    .field{ display:grid; gap:8px; }
    label{ font-weight:600; }
    input[type="text"], input[type="password"], textarea{
      width:100%;
      border:1px solid var(--line);
      border-radius:10px;
      padding:10px 12px;
      font-size:15px;
      font-family:inherit;
      resize:vertical;
      min-height:44px;
    }
    textarea{ min-height:120px; }
    .inline{ display:flex; gap:16px; align-items:center; flex-wrap:wrap; }
    .inline label{ font-weight:500; }
    .secret-toggle{ display:flex; align-items:center; gap:8px; font-size:14px; color:var(--muted); }
    button[type="submit"]{
      justify-self:flex-end;
      background:var(--brand);
      color:#fff;
      border:none;
      border-radius:999px;
      padding:12px 32px;
      font-size:15px;
      cursor:pointer;
      box-shadow:0 12px 30px rgba(255,130,21,.25);
      transition:transform .12s ease, box-shadow .12s ease, background .12s ease;
    }
    button[type="submit"]:hover{ background:#d96500; box-shadow:0 14px 34px rgba(217,101,0,.28); }
    button[type="submit"]:active{ transform:translateY(1px); }

    .notice{ background:rgba(255,130,21,.12); padding:14px 16px; border-radius:12px; font-size:14px; }

    footer{ text-align:center; padding:32px 16px 40px; font-size:13px; color:var(--muted); }

    @media (max-width: 720px){
      header{ padding:48px 16px 60px; }
      header h1{ font-size:28px; }
      main{ padding:0 16px 64px; }
      .board{ padding:24px; border-radius:20px; }
      button[type="submit"]{ justify-self:stretch; }
    }
  </style>
</head>
<body>
  <header>
    <h1>온통대전 문의 · Q&A</h1>
    <p>궁금한 점을 남겨주세요. 답변이 필요한 질문은 담당자가 빠르게 확인하고 회신합니다. 비밀글 옵션을 사용하면 작성자와 관리자만 내용을 볼 수 있습니다.</p>
  </header>
  <main>
    <div class="container">
      <section class="board" aria-label="문의 내역">
        <h2><span>Q</span>최근 문의</h2>
        <p>가맹점 검색, 카드 신청, 앱 사용법 등 다양한 질문을 남겨주세요.</p>
        <div class="notice">※ 비밀글은 작성 시 설정한 비밀번호를 입력해야 열람할 수 있습니다.</div>
        <ul class="post-list" id="postList"></ul>
      </section>
      <section class="board" aria-label="문의 작성">
        <h2><span>A</span>문의 등록</h2>
        <form id="questionForm">
          <div class="field">
            <label for="writer">작성자</label>
            <input id="writer" name="writer" type="text" placeholder="이름 또는 닉네임" required>
          </div>
          <div class="field">
            <label for="title">제목</label>
            <input id="title" name="title" type="text" placeholder="문의 제목" required>
          </div>
          <div class="field">
            <label for="content">내용</label>
            <textarea id="content" name="content" placeholder="문의 내용을 상세히 적어주세요." required></textarea>
          </div>
          <div class="inline">
            <label class="secret-toggle"><input id="isSecret" type="checkbox"> 비밀글로 등록</label>
            <input id="password" type="password" placeholder="비밀번호 (비밀글일 때 필수)" minlength="4" maxlength="12">
          </div>
          <button type="submit">문의 등록</button>
        </form>
      </section>
    </div>
  </main>
  <footer>© 2025 Ontong Daejeon. 문의 게시판.</footer>
  <script>
    var STORAGE_KEY = 'ontong_qna_v1';
    var postListEl = document.getElementById('postList');
    var form = document.getElementById('questionForm');
    var passwordEl = document.getElementById('password');
    var secretEl = document.getElementById('isSecret');

    function loadPosts(){
      try{ return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); }
      catch(e){ return []; }
    }
    function savePosts(posts){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(posts));
    }
    function seedPosts(){
      var sample = [
        { id: Date.now() - 300000, title:'온통대전 사용 가능한 매장 확인 방법', writer:'행복한대전', content:'지도에서 초록 불 아이콘이 뜨는 곳은 온통대전이 가능한 매장입니다. 추가로 확인할 팁이 있을까요?', secret:false, createdAt: Date.now() - 300000 },
        { id: Date.now() - 240000, title:'앱에서 카드 잔액 조회가 되지 않아요', writer:'카드초보', content:'안녕하세요. 최근 카드 잔액이 0원으로 표시됩니다. 다시 로그인하면 정상일까요?', secret:true, password:'1234', createdAt: Date.now() - 240000 },
        { id: Date.now() - 180000, title:'가맹점 스티커 배부 일정 문의', writer:'동구상인회', content:'새로 가맹한 매장입니다. 오프라인 스티커는 언제 받아볼 수 있나요?', secret:false, createdAt: Date.now() - 180000 }
      ];
      savePosts(sample);
      return sample;
    }

    function formatDate(ts){
      var d = new Date(ts);
      return d.getFullYear() + '.' + String(d.getMonth()+1).padStart(2,'0') + '.' + String(d.getDate()).padStart(2,'0');
    }

    function renderPosts(){
      var posts = loadPosts();
      if(!posts.length){ posts = seedPosts(); }
      postListEl.innerHTML = '';
      posts.sort(function(a,b){ return b.createdAt - a.createdAt; });
      posts.forEach(function(post){
        var li = document.createElement('li');
        li.className = 'post-item';
        li.dataset.id = post.id;
        var title = document.createElement('div');
        title.className = 'post-title';
        if(post.secret){
          var lock = document.createElement('span');
          lock.className = 'lock';
          lock.textContent = '🔒';
          title.appendChild(lock);
        }
        title.appendChild(document.createTextNode(post.title));
        var meta = document.createElement('div');
        meta.className = 'post-meta';
        meta.textContent = post.writer + ' · ' + formatDate(post.createdAt);
        var content = document.createElement('div');
        content.className = 'post-content';
        content.textContent = post.secret ? '비밀글입니다. 비밀번호를 입력해주세요.' : post.content;
        li.appendChild(title);
        li.appendChild(meta);
        li.appendChild(content);
        li.addEventListener('click', function(){
          togglePost(post, content, li);
        });
        postListEl.appendChild(li);
      });
    }

    function togglePost(post, contentEl, li){
      if(post.secret){
        var input = prompt('비밀글 비밀번호를 입력하세요.');
        if(input === null) return;
        if(input !== post.password){
          alert('비밀번호가 일치하지 않습니다.');
          return;
        }
        contentEl.textContent = post.content;
      }
      li.classList.toggle('open');
    }

    form.addEventListener('submit', function(ev){
      ev.preventDefault();
      var data = new FormData(form);
      var writer = data.get('writer').trim();
      var title = data.get('title').trim();
      var content = data.get('content').trim();
      var secret = secretEl.checked;
      var password = passwordEl.value.trim();
      if(!writer || !title || !content){
        alert('작성자, 제목, 내용을 모두 입력해주세요.');
        return;
      }
      if(secret && password.length < 4){
        alert('비밀글은 4자 이상 비밀번호를 입력해야 합니다.');
        passwordEl.focus();
        return;
      }
      var posts = loadPosts();
      posts.push({
        id: Date.now(),
        writer: writer,
        title: title,
        content: content,
        secret: secret,
        password: secret ? password : '',
        createdAt: Date.now()
      });
      savePosts(posts);
      form.reset();
      secretEl.checked = false;
      alert('문의가 등록되었습니다. 빠르게 답변드릴게요.');
      renderPosts();
    });

    secretEl.addEventListener('change', function(){
      if(this.checked){
        passwordEl.required = true;
        passwordEl.placeholder = '비밀번호 (4~12자)';
      }else{
        passwordEl.required = false;
        passwordEl.value = '';
        passwordEl.placeholder = '비밀번호 (비밀글일 때 필수)';
      }
    });

    renderPosts();
  </script>
</body>
</html>